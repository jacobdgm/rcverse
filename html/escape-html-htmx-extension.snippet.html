<script>
  // Stolen from NakedJSX https://github.com/NakedJSX/core
  // Appears to be adapted from this SO answer https://stackoverflow.com/a/77873486
  const escapeHtml = (text) => {
    const htmlEscapeMap = {
      "&": "&amp;",
      "<": "&lt;",
      ">": "&gt;",
      '"': "&quot;",
      "'": "&#039;",
    };

    return text.replace(/[&<>"']/g, (m) => htmlEscapeMap[m] ?? "");
  };

  htmx.defineExtension("escape-html", {
    transformResponse: function (text, xhr, elt) {
      return escapeHtml(text);
    },
  });
</script>
